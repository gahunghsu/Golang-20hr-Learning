# Day 12ï¼šChannel ç·´ç¿’ ğŸ¯

ä»Šå¤©çš„é‡é»æ˜¯ **Channel**ï¼Œç‰¹åˆ¥è§€å¯Ÿ **ç„¡ç·©è¡** (`-bufsize=0`) èˆ‡ **æœ‰ç·©è¡** (`-bufsize=N`) çš„å·®ç•°ã€‚

---

## ğŸ“Œ ç¨‹å¼èªªæ˜

é€™å€‹ç¯„ä¾‹æ¨¡æ“¬ä¸€å€‹ **Producer-Worker-Consumer** çš„æµç¨‹ï¼š

1. **Producer (P)**  
   å°‡ä»»å‹™é€é€² `jobs` channelã€‚
2. **Workers (W1, W2, W3 â€¦)**  
   å¾ `jobs` æ‹¿åˆ°ä»»å‹™å¾Œï¼ŒåŸ·è¡Œè¨ˆç®—ï¼ˆæ¨¡æ“¬è€—æ™‚ `workms` æ¯«ç§’ï¼‰ã€‚
3. **Consumer (C)**  
   æ”¶é›†æ‰€æœ‰çµæœä¸¦è¼¸å‡ºã€‚

ç¨‹å¼å¯é€éåƒæ•¸èª¿æ•´ï¼š

- `-jobs`ï¼šç¸½ä»»å‹™æ•¸é‡  
- `-workers`ï¼šWorker æ•¸é‡  
- `-bufsize`ï¼š`jobs` channel ç·©è¡å¤§å°ï¼ˆ0=ç„¡ç·©è¡ï¼‰  
- `-workms`ï¼šæ¯å€‹ä»»å‹™æ¨¡æ“¬è€—æ™‚ (ms)  
- `-samebuf`ï¼šæ˜¯å¦è®“ `results` çš„ç·©è¡èˆ‡ `jobs` ç›¸åŒ  

---

## ğŸš€ åŸ·è¡Œæ–¹å¼

```bash
# ç„¡ç·©è¡ channel
go run worker.go -jobs=5 -workers=3 -bufsize=0 -workms=200

# æœ‰ç·©è¡ channelï¼ˆä¾‹å¦‚ bufsize=3ï¼‰
go run worker.go -jobs=5 -workers=3 -bufsize=3 -workms=200
````

---

## ğŸ” è§€å¯Ÿé‡é»

### 1. ç„¡ç·©è¡ (`-bufsize=0`)

* Producer `jobs <- j` **æœƒé˜»å¡**ï¼Œç›´åˆ°æœ‰ Worker æ­£åœ¨æ¥æ”¶ã€‚
* Log æœƒå‘ˆç¾ **ã€Œä¸€æ”¶ä¸€é€ã€äº¤éŒ¯**ï¼š

```text
[P  0s] -> jobs (enqueue 1)
[W1 0s] <- job 1
[P  0s] enqueued 1
```

### 2. æœ‰ç·©è¡ (`-bufsize=N`)

* Producer å¯ä»¥å…ˆé€£çºŒä¸Ÿ N å€‹ä»»å‹™é€² `jobs`ï¼Œä¸æœƒé¦¬ä¸Šè¢«é˜»å¡ã€‚
* Log æœƒå‘ˆç¾ **ã€ŒProducer å…ˆé€£ç™¼ï¼ŒWorker æ…¢æ…¢æ¶ˆåŒ–ã€**ï¼š

```text
[P  0s] -> jobs (enqueue 1)
[P  0s] enqueued 1
[P  0s] -> jobs (enqueue 2)
[P  0s] enqueued 2
[P  0s] -> jobs (enqueue 3)
[P  0s] enqueued 3
[W1 0s] <- job 1
[W2 0s] <- job 2
[W3 0s] <- job 3
```

---

## ğŸ¤” å­¸ç¿’å¿ƒå¾—

* **ç„¡ç·©è¡**ï¼šå¼·åˆ¶åŒæ­¥ï¼ŒProducer èˆ‡ Worker ä¸€ä¸€é…å°ï¼Œå¸¸ç”¨æ–¼ã€Œç¢ºèªå°æ–¹å·²æ”¶åˆ°ã€çš„æƒ…å¢ƒã€‚
* **æœ‰ç·©è¡**ï¼šå…è¨±çŸ­æš«çš„ã€Œå·¥ä½œå †ç©ã€ï¼ŒProducer å¯ä»¥å…ˆè·‘ä¸€æ®µï¼ŒWorker å†æ…¢æ…¢è™•ç†ã€‚
* å°æ‡‰åˆ°ç¾å¯¦ä¸–ç•Œï¼š

  * ç„¡ç·©è¡ â†’ å·¥äººå¿…é ˆåœ¨å ´æ‰èƒ½æ¥å–®ã€‚
  * æœ‰ç·©è¡ â†’ å¯ä»¥å…ˆæŠŠè²¨æ”¾åˆ°å€‰åº«ï¼Œå·¥äººä¹‹å¾Œå†ä¾†è™•ç†ã€‚

```
